<div class="create-product">
  <div class="container">
    <div class="title-row">
      <div class="title-left">
        <h1 class="title">{{ isEditMode ? 'Edit Product' : 'Add New Product' }}</h1>
        <p class="subtitle">Enter complete product details for a professional listing.</p>
      </div>
      <div class="title-right" *ngIf="isEditMode">
        <a class="btn btn-outline" [routerLink]="['/product', productId]">View Product</a>
      </div>
    </div>

    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="product-form">
      <div class="grid">
        <!-- Basic Info -->
        <div class="card">
          <h2>Basic Information</h2>
          <div class="field">
            <label for="name">Name<span class="req">*</span></label>
            <input id="name" type="text" formControlName="name" placeholder="e.g., Fresh Alphonso Mango"/>
            <div class="error" *ngIf="f['name'].touched && f['name'].invalid">Name is required</div>
          </div>
          <div class="field">
            <label for="description">Description</label>
            <textarea id="description" rows="4" formControlName="description" placeholder="Describe the product"></textarea>
          </div>
          <div class="row">
            <div class="field">
              <label for="category">Category<span class="req">*</span></label>
              <select id="category" formControlName="category">
                <option value="" disabled>Select category</option>
                <option *ngFor="let c of categories" [value]="c">{{ c }}</option>
              </select>
              <div class="error" *ngIf="f['category'].touched && f['category'].invalid">Category is required</div>
            </div>
            <div class="field">
              <label for="subcategory">Subcategory</label>
              <input id="subcategory" type="text" formControlName="subcategory" placeholder="e.g., tropical"/>
            </div>
          </div>
        </div>

        <!-- Pricing -->
        <div class="card">
          <h2>Pricing</h2>
          <div class="row">
            <div class="field">
              <label for="price">Price<span class="req">*</span></label>
              <input id="price" type="number" step="0.01" min="0" formControlName="price" placeholder="0.00"/>
            </div>
            <div class="field">
              <label for="originalPrice">Original Price</label>
              <input id="originalPrice" type="number" step="0.01" min="0" formControlName="originalPrice" placeholder="0.00"/>
            </div>
            <div class="field">
              <label for="discount">Discount</label>
              <input id="discount" type="number" step="0.01" min="0" formControlName="discount" placeholder="0"/>
            </div>
          </div>
        </div>

        <!-- Inventory -->
        <div class="card">
          <h2>Inventory</h2>
          <div class="row">
            <div class="field">
              <label for="inStock">In Stock</label>
              <input id="inStock" type="checkbox" formControlName="inStock"/>
            </div>
            <div class="field">
              <label for="quantity">Quantity</label>
              <input id="quantity" type="number" min="0" formControlName="quantity" placeholder="0"/>
            </div>
            <div class="field">
              <label for="unit">Unit</label>
              <select id="unit" formControlName="unit">
                <option *ngFor="let u of units" [value]="u">{{ u }}</option>
              </select>
            </div>
          </div>
          <div class="row">
            <div class="field checkbox">
              <label><input type="checkbox" formControlName="featured"/> Featured</label>
            </div>
            <div class="field checkbox">
              <label><input type="checkbox" formControlName="organic"/> Organic</label>
            </div>
            <div class="field checkbox">
              <label><input type="checkbox" formControlName="fresh"/> Fresh</label>
            </div>
          </div>
        </div>

        <!-- Media -->
        <div class="card">
          <h2>Media</h2>
          <div class="field">
            <label for="image">Primary Image URL<span class="req">*</span></label>
            <input id="image" type="url" formControlName="image" placeholder="https://..."/>
          </div>
          <div class="field">
            <label for="images">Additional Image URLs (comma separated)</label>
            <input id="images" type="text" formControlName="images" placeholder="https://..., https://..."/>
          </div>
        </div>

        <!-- Identifiers and Attributes -->
        <div class="card">
          <h2>Attributes</h2>
          <div class="row">
            <div class="field">
              <label for="sku">SKU</label>
              <input id="sku" type="text" formControlName="sku" placeholder="Auto-generated if empty"/>
            </div>
            <div class="field">
              <label for="barcode">Barcode</label>
              <input id="barcode" type="text" formControlName="barcode" />
            </div>
          </div>
          <div class="row">
            <div class="field">
              <label for="weightKg">Weight (kg)</label>
              <input id="weightKg" type="number" step="0.001" min="0" formControlName="weightKg"/>
            </div>
            <div class="field">
              <label for="shelfLifeDays">Shelf Life (days)</label>
              <input id="shelfLifeDays" type="number" min="0" formControlName="shelfLifeDays"/>
            </div>
          </div>
          <div class="field">
            <label for="storageInstructions">Storage Instructions</label>
            <input id="storageInstructions" type="text" formControlName="storageInstructions" placeholder="Keep refrigerated"/>
          </div>
          <div class="row">
            <div class="field">
              <label for="originCountry">Origin Country</label>
              <input id="originCountry" type="text" formControlName="originCountry" placeholder="e.g., India"/>
            </div>
            <div class="field">
              <label for="supplierName">Supplier/Seller Name</label>
              <input id="supplierName" type="text" formControlName="supplierName" placeholder="e.g., M-Mart Sellers"/>
            </div>
          </div>
        </div>

        <!-- Nutrition -->
        <div class="card">
          <h2>Nutritional Information (per 100g)</h2>
          <div class="row">
            <div class="field">
              <label for="caloriesPer100g">Calories</label>
              <input id="caloriesPer100g" type="number" min="0" formControlName="caloriesPer100g"/>
            </div>
            <div class="field">
              <label for="proteinG">Protein (g)</label>
              <input id="proteinG" type="number" step="0.01" min="0" formControlName="proteinG"/>
            </div>
            <div class="field">
              <label for="carbsG">Carbs (g)</label>
              <input id="carbsG" type="number" step="0.01" min="0" formControlName="carbsG"/>
            </div>
          </div>
          <div class="row">
            <div class="field">
              <label for="fatG">Fat (g)</label>
              <input id="fatG" type="number" step="0.01" min="0" formControlName="fatG"/>
            </div>
            <div class="field">
              <label for="fiberG">Fiber (g)</label>
              <input id="fiberG" type="number" step="0.01" min="0" formControlName="fiberG"/>
            </div>
          </div>
          <div class="field">
            <label for="vitamins">Vitamins (comma separated)</label>
            <input id="vitamins" type="text" formControlName="vitamins" placeholder="Vitamin A, Vitamin C"/>
          </div>
        </div>
      </div>

      <div class="actions">
        <button type="submit" class="btn btn-primary" [disabled]="isSubmitting">
          {{ isSubmitting ? (isEditMode ? 'Saving...' : 'Creating...') : (isEditMode ? 'Save Changes' : 'Create Product') }}
        </button>
        <a routerLink="/products" class="btn btn-outline">Cancel</a>
      </div>

      <div class="error submit-error" *ngIf="submitError">{{ submitError }}</div>
    </form>
  </div>
</div>


